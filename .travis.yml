# Info about vm and jvm.
language: scala

os:
  - linux
  - osx
  - windows

dist: xenial

jdk:
  - openjdk11 # Java version. Add other Java versions under this.

scala:
  - 2.12.11 # Scala version. Add other Scala versions under this.
  # - 2.13.3 Last stable version

git:
  autocrlf: input

# Trigger build only on master branch.
branches:
  only:
    - master # build master branch only.
    - dev

jobs:
  exclude:
    - os: windows # Windows dose not compile in scala.
      language: scala

# We've enabled by default coverage functionality.
script:
  - bash deploy.sh # generate static files.

# Send notifications to those address.
# notifications:
#   email:
#     recipients:
#       - d.tentoni@wedoit.io
#       - daniele.tentoni2@studio.unibo.it
#       - l.giorgetti@wedoit.io
#       - luca.giorgetti@studio.unibo.it
#       - lorenzo.pagnini@studio.unibo.it
#       - daniele.tentoni.1996@gmail.com
#     on_success: change
#     on_failure: always

# Deploy to GitHub some infos.
deploy:
  - provider: pages # Deploy to Github pages.
    strategy: git
    skip_cleanup: true # Don't clean up build directories.
    token: $GH_TOKEN
    keep_history: true
    on:
      branch: master # Deploy only commit to master branch.
    local_dir: public
  - provider: releases # Deploy to Github Releases.
    strategy: git
    skip_cleanup: true
    token: $GH_TOKEN
    file_glob: true
    file: client/target/scala-*/*SNAPSHOT.jar
    on:
      branch: master # Deploy only commit to master branch with a tag.
      tags: true